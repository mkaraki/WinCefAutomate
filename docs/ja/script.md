# WinCefAutomateスクリプト

## `name`属性
スクリプトの名前を設定します。
設定した名称はメニュー画面のスクリプト一覧で利用されます。

## `dataset`セクション
`dataset`セクションでは、記述などに利用するデータセットを定義します。

### `file`指定
ファイルからデータを読みだす際に利用するファイル名を指定します。
ファイルは`scripts`ディレクトリに含まれている必要があります。

### `type`指定
利用するファイル形式は以下の通りです。
- 1行1データのプレーンテキスト

## `steps`セクション
`steps`セクションは実際に自動化する動作を配列で記述します。

### `name`属性
name属性はステップに設定する動作内容を設定できる属性です。
この値は実行画面の進捗表示で利用されます。

### `action`属性
`action`属性は実際に行う動作を定義します。
下記のactionが存在します。

#### go
指定されたURLに移動します。

- `where`を併用して、URLを定義する必要があります。

#### waituser
ユーザがOKボタンを押すまでスクリプトを停止します。

- `message`属性で任意のメッセージを指定することも可能です。

#### click
特定のエレメントをクリックします。

- `where`に対象のエレメントを指定してください。
- `document.querySelector`で指定可能な形式を利用してください。

#### setval
特定のinputエレメントに値を挿入します。

- `where`に対象のエレメントを指定してください。
- `what`に値を指定してください。
- `document.querySelector`で指定可能な形式を利用してください。

#### sleep
任意の時間スクリプトを一時停止します。

- `time`に秒数を指定してください

#### goto
別のステップで定義されている`gotoid`に移動します。
このactionは主に繰り返しで利用することを想定しています。

- `id`に移動先`gotoid`を指定してください。

#### evalgoto
JavaScriptの評価が真の場合、`goto`と同じ動作をします。

- `id`に移動先`gotoid`を指定してください。
- `what`にevalする式を指定してください。
- `logres`を`true`に設定すると、結果がログに保存されます。

#### shift
次のデータセットの値を呼び出します。

#### logstr
任意の文字列をログに残します

- `message`属性に内容を記述する必要があります。

#### logeval
JavaScriptの演算結果をログファイルに記述します。

- `message`を指定することでカスタムのメッセージを先頭に付けることが可能です。
- `what`にevalする式を指定してください。
